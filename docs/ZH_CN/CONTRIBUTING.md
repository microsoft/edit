# 贡献

## 翻译改进

您可以在 [`src/bin/edit/localization.rs`](./src/bin/edit/localization.rs)找到我们的本地化内容。
请随时打开包含您的更改的拉取请求。
如果您想先讨论您的更改，请随时打开一个 Issue。

## Bug 报告

如果您发现任何错误，我们很乐意接受拉取请求，无需事先讨论。
当然，您也可以随时打开一个 Issue 供我们进行讨论。

## 功能请求

请为您考虑的任何功能请求打开一个新的 Issue。
保持编辑器的二进制包较小是我们的首要任务，因此我们可能需要先讨论任何新功能，直到我们支持插件。

## 代码更改

该项目的重点是更小的二进制包大小和足够的 （良好的） 性能。
因此，我们通常不接受引入依赖项的拉取请求（当然，凡事总有例外）。
否则，任何人都可以将此项目视为尝试任何酷想法的涂鸦墙。

该项目的整体架构可以总结如下：
* `src/buffer`中的底层文本缓冲区不会跟踪文档中的换行符。
  这是贯穿整个代码库的关键设计方面。

  简单来说，*唯一* 保留的状态是当前光标位置。
  当用户要求移动到另一行时，编辑器将 `O(n)` 搜索底层文档，直到找到相应的换行符数。
  * 因此， `src/simd` 包含关键的 `memchr2` 函数，可快速找到下一个或上一个换行符（运行速度高达 >100GB/s）。
  * 此外，`src/unicode` 实现了一个 `Utf8Chars` 迭代器，它在迭代期间透明地插入 U+FFFD 替换（运行速度高达 4GB/s）。
  * 此外，`src/unicode` 还通过其 `MeasurementConfig` 实现字形簇分割和簇宽测量（运行速度高达 600MB/s）。
  * 如果禁用自动换行，则 `memchr2` 用于所有跨行导航，允许我们轻松浏览 1GB 的大文件，就像它们是 1MB 一样。
  * 即使启用了自动换行，由于 `MeasurementConfig`，它仍然足够流畅。这只是因为这些基本函数经过了大量优化。
* `src/framebuffer.rs` 实现一个 “framebuffer”，就像在视频游戏中一样。
  它允许我们首先将 UI 输出绘制到中间缓冲区中，累积所有更改并处理颜色混合等作。
  然后，它可以将累积的输出与前一帧进行比较，并且只将必要的更改发送到终端。
* `src/tui.rs` 实现即时模式 UI。它的模块实现概述了它是如何工作的，建议阅读它。
* `src/vt.rs` 实现我们的 VT 解析器。
* `src/sys` 包含我们的跨平台抽象层。
* 最后，`src/bin/edit` 把所有东西都绑在一起。
  它大约包含 90% 的 UI 和业务逻辑代码。
  它在 `setup_terminal` 中包含一点 VT 逻辑。

如果您的终端有问题，感兴趣的地点是前面提到的：
* “src/vt.rs”中的 VT 解析器
* “src/sys”中的平台特定代码
* 以及 `src/bin/edit/main.rs` 中的 `setup_terminal` 函数
